#! /usr/bin/env ruby
require 'dotenv/load'
require 'optparse'
require 'pry'
require 'google/cloud/firestore'

firestore_options = {}
OptionParser.new do |opts|
  opts.on('-p', '--project-id PROJECT-ID', 'GCP project ID') { |opt| firestore_options[:project_id] = opt }
  opts.on('-k', '--keyfile KEYFILE', 'GCP keyfile') { |opt| firestore_options[:keyfile] = opt }
  opts.on('-e', '--endpoint ENDPOINT', 'Firestore endpoint URL') { |opt| firestore_options[:endpoint] = opt }
end.parse!

@firestore = Google::Cloud::Firestore.new(**firestore_options)
def firestore
  @firestore
end
alias db firestore

Pry.start
