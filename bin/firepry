#! /usr/bin/env ruby
require 'optparse'
require 'pry'
require 'google/cloud/firestore'

firestore_options = {}
OptionParser.new do |opts|
  opts.on('-p', '--project-id PROJECT-ID', 'GCP project ID') do |opt|
    firestore_options[:project_id] = opt
  end

  opts.on('-k', '--keyfile KEYFILE', 'GCP keyfile') do |opt|
    firestore_options[:keyfile] = opt
  end

  opts.on('-e', '--endpoint ENDPOINT', 'Firestore endpoint URL') do |opt|
    firestore_options[:endpoint] = opt
  end
end.parse!

@firestore = Google::Cloud::Firestore.new(**firestore_options)

def firestore
  @firestore
end
alias db firestore

Pry.start
